# 要件定義（Requirements Definition）

## 1. As-Is（現状業務フローと課題）
- **フロー**: 作業者がAWSコンソール等を目視・手動操作し、その都度スクリーンショットを取得。その後Word/Excel/Markdown等に画像を貼り付け、文章を手書きして手順書を作成している。
- **課題**: 
  - 画面キャプチャの取得・貼り付け・文章化に膨大な工数がかかっている。
  - Web UI（AWSなど）の頻繁な更新により、手順書がすぐに陳腐化し、メンテナンスが追いつかない。
  - 作成者によって記載の粒度、品質、更新頻度がバラバラになり属人化が激しい。

## 2. To-Be（自動化後の業務像）
- UIを自動操作し、そのプロセスの中で画面キャプチャ（証跡）と操作ログを自動取得する。
- 取得したログと画像から、AIがMarkdown等の手順書を自動生成する。
- UIが変更された場合でも、AIによるUI認識（Self-healing）により操作の中断を防ぎ、変更に追従する。
- 完全無人化ではなく、「安全に自動」を優先し、重要な操作や不確実な局面では人手介入を可能とする。

## 3. 業務要件
- **対象業務**: AWS環境構築など、複数サービス（VPC, EC2, WorkSpaces, SG等）を跨ぐ大規模かつ一連の操作手順の実行および手順書化。
- **非対象業務**: 自由記述や人間による高度な意味解釈が必要な業務、非定型な探索的トラブルシューティング。
- **利用者**:
  - 作成者（最終的には全エンジニア陣へツールを配布し、自身のローカルPCや踏み台サーバー上で実行させる）
  - レビュー者（生成された手順書の内容や証跡を確認する管理者）

## 4. 機能要件
- **UI自動操作**: 指定されたシナリオに基づくWebブラウザ等の操作実行。
- **AI UI認識**: DOMや画像から操作対象の要素を特定・補正する。
- **スクリーンショット自動取得**: 状態変化（クリック前後、画面遷移、エラー発生）時のキャプチャ保存。
- **操作ログ取得**: 「いつ・どこを・どう操作したか」の構造化ログ出力。
- **手順書自動生成**: ログとキャプチャを統合したMarkdownファイル出力。
- **マスキング**: キャプチャ画像内のPII/機密情報を黒塗り等で隠蔽。
- **再実行・途中再開**: 失敗時点からの再開、またはチェックポイントからのリカバリ機能。

## 5. 非機能要件
- **正確性・誤操作防止**: 候補が複数ある場合や許可リスト外の操作は即座に停止して人に委ねる。
- **監査性・説明可能性**: なぜその要素を操作したのか（判定理由のログ）、操作前後のスクショとDOM状態の保存。
- **再現性**: 同じ環境・同じシナリオで同様の結果となること。
- **セキュリティ/PII**: データはローカルPC内またはセキュリティが確保されたVPC内で完結し、外部公開LLMに学習データを流出させない。
- **UI変更耐性**: 要素のID/Class変更でもラベルや視覚情報で要素を特定し追従する能力。
- **運用負荷**: メンテナンス・再設定の手間が手動作成より大幅に低いこと。

## 6. 制約条件（確定事項）
- **認証とMFA**: MFAは不要な想定。認証が必要な場合は **AWS Secrets Manager** から自動取得するか、ツール実行時に都度人手入力を求める方式とする。
- **実行環境**: オペレータのローカルPC、または専用の踏み台サーバー。全エンジニアへの配布を最終目標とする。
- **データ送信とマスキング**: ローカルでのPIIマスキング処理は必須とせず、取得したキャプチャをそのままAIへ送信することを許容する。これによりローカルツールの軽量化を図る。
- **利用するAI環境**: 画像をそのまま送信するため、外部にデータが流出・学習されないセキュアな閉域環境である **Amazon Bedrock** の利用を必須とする。

## 7. 成功条件（Done定義・KPI）
- 定常作業の手順書作成にかかるリードタイムが50%以上削減されること。
- AWSのUI小変更（DOM変更等）に対して、スクリプト改修なしで既存の自動化シナリオが80%以上の確率で完走すること。
- 生成された手順書がそのままレビュー・実運用に耐えうる粒度・品質であること。
