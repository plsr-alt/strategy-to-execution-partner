# 手順書自動化 — 実装過程のドキュメント設計
_作成: 2026-02-20_

---

## 設計コンセプト

**「記録のために立ち止まらない」**
すべてのログは「作業の副産物として自動収集される」か、「最小入力で完了する」構造にする。

---

## 1. ディレクトリ構造

```
03_PROJECTS/runbook_automation/
├── README.md                      # インデックス・現在のステータス
├── 01_方式調査.md
├── 02_推奨アーキテクチャ.md
├── 03_PoC設計.md
├── 04_ドキュメント設計.md
├── 05_社内提案資料.md
│
└── logs/
    ├── _templates/
    │   ├── research_log_template.md      # 調査ログ雛形
    │   ├── decision_log_template.md      # 意思決定ログ雛形
    │   ├── experiment_log_template.md    # 実験ログ雛形
    │   └── change_log_template.md        # 変更履歴雛形
    │
    ├── research/
    │   └── YYYY-MM-DD_調査タイトル.md
    ├── decisions/
    │   └── YYYY-MM-DD_決定タイトル.md
    ├── experiments/
    │   └── YYYY-MM-DD_実験タイトル.md
    └── changes/
        └── CHANGELOG.md                  # 1ファイルに追記形式
```

---

## 2. 各ログの記入ルール

### 2-1. 調査ログ（research/）
**トリガー**: 新しい技術・サービス・手法を調べたとき
**記入コスト**: 5分以内で書ける量のみ

```markdown
# [調査タイトル]
日付: YYYY-MM-DD
調査者:

## 調査した背景（1〜2行）

## わかったこと（箇条書き）
-

## わからなかったこと・次に調べること
-

## 参考URL
-
```

### 2-2. 意思決定ログ（decisions/）
**トリガー**: 方式・ツール・設計を「これにする」と決めたとき
**重要度**: 最も残す価値が高い。後で「なぜそうなったか」を参照するため。

```markdown
# [決定タイトル]
日付: YYYY-MM-DD
決定者:

## 決定内容（1行）

## 選択肢と比較
| 案 | メリット | デメリット |
|----|---------|-----------|
| A  |         |           |
| B  |         |           |

## 選んだ理由（2〜3行）

## 前提条件（これが変わったら再検討）
-

## 次のアクション
-
```

### 2-3. 実験ログ（experiments/）
**トリガー**: プロンプトや設定を変えて試したとき
**記入コスト**: 計測値さえあれば2分で書ける

```markdown
# [実験タイトル]
日付: YYYY-MM-DD
実施者:

## 仮説
（何を変えると何が改善されると思ったか）

## 変更内容
- Before:
- After:

## 結果
| 指標 | Before | After |
|------|--------|-------|
| 精度 |        |       |
| 処理時間 |    |       |

## 結論（1行）

## 次の実験アイデア
-
```

### 2-4. 変更履歴（changes/CHANGELOG.md）
**トリガー**: コードやプロンプトに変更を加えたとき
**形式**: 追記のみ。古いものは消さない。

```markdown
## YYYY-MM-DD

### 変更したもの
- [ファイル名 or コンポーネント]: 変更内容

### 理由
-

### 影響範囲
-
---
```

---

## 3. 自動化できる部分

### Lambdaで自動収集するもの（エンジニア作業ゼロ）

| ログ種別 | 収集内容 | 保存先 |
|---------|---------|--------|
| 処理ログ | 画像ファイル名・Textract出力JSON・Bedrock入出力・信頼度スコア・処理時間 | S3: `logs/pipeline/YYYY-MM-DD/` |
| エラーログ | エラー種別・スタックトレース・入力画像パス | CloudWatch Logs |
| 精度ログ | フィールドごとの信頼度・レビューフラグ有無 | S3: `logs/accuracy/` |
| 修正ログ | Sheets上での人間修正（Before/After） | S3: `logs/corrections/`（Sheets Apps Script連携）|

### Sheetsで自動収集するもの（Sheets Apps Scriptで実装）
- セルを修正したとき → 修正前後の値をS3にPOST
- 承認ボタンを押したとき → 承認者・日時を記録

---

## 4. README.md（プロジェクトインデックス）の更新ルール

`README.md` のステータス欄だけは毎週更新する（所要1分）。

```markdown
## 現在のステータス
_更新: YYYY-MM-DD_

| フェーズ | 状態 |
|---------|------|
| PoC Week1 | ✅ 完了 |
| PoC Week2 | 🔄 進行中 |
| PoC Week3 | ⬜ 未着手 |

## 直近の意思決定
- YYYY-MM-DD: [決定タイトル](./logs/decisions/...)

## 直近の実験結果
- YYYY-MM-DD: 精度 XX% → XX%（[詳細](./logs/experiments/...)）

## 次のアクション（最大3つ）
1.
2.
3.
```

---

## 5. Claude Codeとの連携方法

プロジェクト作業中は以下のトリガー語を使うだけで自動的に記録される：

| 発言 | Claudeの動作 |
|------|-------------|
| 「〜を調査した」 | `logs/research/` に調査ログを自動作成 |
| 「〜にした」「〜を選んだ」 | `logs/decisions/` に意思決定ログを自動作成 |
| 「〜を試した、結果は〜」 | `logs/experiments/` に実験ログを自動作成 |
| 「〜を変更した」 | `logs/changes/CHANGELOG.md` に追記 |
| 「ステータス更新して」 | `README.md` の現在のステータス欄を更新 |

---

_このドキュメント設計は `/01_MANUAL/` にコピーして全プロジェクト共通化することを推奨_
