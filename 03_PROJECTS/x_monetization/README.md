# x-research-skills (xrs)

xAI (Grok) の API を活用して、X (旧Twitter) の特定の話題を自動で広く薄く探索し、クラスター化・補強検索を経て、SNS投稿やブログのネタとなる素材リスト（Markdown）を自動生成する CLI ツールです。

## 特徴
1. **API利用の最適化**: 検索結果をローカルキャッシュ(`.cache/`)に保存し、24時間以内の同一検索はAPIを叩かず再利用します。
2. **多段パイプライン**: 
   - [A] トピックから広範な検索クエリを複数生成
   - [B] 初期検索の実行
   - [C] 得られたポスト群から「話題のクラスター（テーマ）」を抽出
   - [D] クラスターの特徴語から追加検索を行い、情報を自律的に補強
   - [F] 最終的な素材リストをMarkdownとして出力
3. **安全設計**: 投資助言（買い/売り推奨、目標株価など）につながる断定表現を排除し、必ず注意文を添えるプロンプト設計になっています。また、他者の投稿の「長文の直接引用」は行わず、URLと要約のみを出力します。

## セットアップ

### 1. インストール
Node.js (v20以上推奨) と npm を用意し、リポジトリ内でパッケージをインストールします。

```bash
npm install
npm run build
```

### 2. 環境変数の設定
プロジェクトルートに `.env` ファイルを作成し、xAI の API キーを設定してください。（`.env.example` 参照）

```env
XAI_API_KEY=xai-xxxxxxxxxxxxxxxxxxxxxxx
```

***⚠️ 警告:** `.env` ファイルやAPIキーを絶対にGitリポジトリにコミットしたり、公開したりしないでください。*

## 使い方

ビルド後、`dist/cli.js` を実行するか、開発環境では `npm run dev` 経由で実行します。

### 基本コマンド
```bash
node dist/cli.js run --topic "AI developer tools" --hours 24 --count 12
```

### オプション
- `--topic <string>`: 検索したい必須のテーマ・トピック
- `--hours <number>`: 何時間前までのポストを検索するか (デフォルト: 24)
- `--count <number>`: 最終的に出力する素材リストの件数 (デフォルト: 12)
- `--lang <string>`: 検索言語 (ja | en、デフォルト: ja)
- `--mode <string>`: 探索モード。trending (トレンド重視) / buzz (エンゲージメント重視) / balanced (バランス型) (デフォルト: balanced)
- `--seed <string>`: 検索に優先的に含めたいシードキーワード (カンマ区切り)
- `--must <string>`: 検索結果に必ず含めたい語句
- `--out <string>`: 結果をファイル出力する場合のパス (例: `result.md`)
- `--dry-run`: 検索クエリの生成だけ行い、実際の検索(API消費)は行わずに終了します。
- `--no-cache`: キャッシュを利用せず、常に最新のAPI通信を行います。

### 実行例
週末のブログ用ネタ探しとして、Web3インフラ系の話題を48時間分、シードワードを指定して検索する例：
```bash
npm run dev -- run --topic "web3 infra" --hours 48 --count 10 --seed "Agent Teams, Claude Code" --lang ja --out ./outputs/web3_trends.md
```

## 注意事項 (Disclaimer)
- **API課金**: 本ツールは内部で複数回（クエリ生成、検索、クラスタリング、レポーティング）APIをコールします。過度な連続実行はAPIの利用枠や課金額にご注意ください。
- **投資助言の禁止**: 出力される内容はあくまでSNSのトレンド要約であり、金融・投資への助言、売買の推奨を意図するものではありません。
- **引用のルール**: 著作権への配慮から、POSTの本文をそのまま引用するのではなく「URLと概要」の形式で出力します。
